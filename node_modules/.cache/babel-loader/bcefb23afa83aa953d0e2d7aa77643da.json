{"ast":null,"code":"/**\n * this handles how plugins are added to rxdb\n * basically it changes the internal prototypes\n * by passing them to the plugins-functions\n */\nimport RxSchema from './rx-schema';\nimport Crypter from './crypter';\nimport { basePrototype as RxDocumentPrototype } from './rx-document';\nimport RxQuery from './rx-query';\nimport RxCollection from './rx-collection';\nimport RxDatabase from './rx-database';\nimport PouchDB from './pouch-db';\nimport overwritable from './overwritable';\nimport { HOOKS } from './hooks';\n/**\n * prototypes that can be manipulated with a plugin\n * @type {Object}\n */\n\nvar PROTOTYPES = {\n  RxSchema: RxSchema.RxSchema.prototype,\n  Crypter: Crypter.Crypter.prototype,\n  RxDocument: RxDocumentPrototype,\n  RxQuery: RxQuery.RxQuery.prototype,\n  RxCollection: RxCollection.RxCollection.prototype,\n  RxDatabase: RxDatabase.RxDatabase.prototype\n};\nvar ADDED_PLUGINS = new Set();\nexport function addPlugin(plugin) {\n  // do nothing if added before\n  if (ADDED_PLUGINS.has(plugin)) return;else ADDED_PLUGINS.add(plugin);\n\n  if (!plugin.rxdb) {\n    // pouchdb-plugin\n    if (typeof plugin === 'object' && plugin[\"default\"]) plugin = plugin[\"default\"];\n    PouchDB.plugin(plugin);\n  } // prototype-overwrites\n\n\n  if (plugin.prototypes) {\n    Object.entries(plugin.prototypes).forEach(function (_ref) {\n      var name = _ref[0],\n          fun = _ref[1];\n      return fun(PROTOTYPES[name]);\n    });\n  } // overwritable-overwrites\n\n\n  if (plugin.overwritable) {\n    Object.entries(plugin.overwritable).forEach(function (_ref2) {\n      var name = _ref2[0],\n          fun = _ref2[1];\n      return overwritable[name] = fun;\n    });\n  } // extend-hooks\n\n\n  if (plugin.hooks) {\n    Object.entries(plugin.hooks).forEach(function (_ref3) {\n      var name = _ref3[0],\n          fun = _ref3[1];\n      return HOOKS[name].push(fun);\n    });\n  }\n}\nexport default {\n  addPlugin: addPlugin,\n  overwritable: overwritable\n};","map":null,"metadata":{},"sourceType":"module"}
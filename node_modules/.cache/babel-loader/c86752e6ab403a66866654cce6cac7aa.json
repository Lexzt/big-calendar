{"ast":null,"code":"var _this = this;\n\nimport { BEGIN_GOOGLE_AUTH, BEGIN_GOOGLE_LOAD, successGoogleAuth } from '../redux/actions';\nimport { mergeMap } from 'rxjs/operators';\nimport { ofType } from 'redux-observable';\nvar GOOGLE_CLIENT_ID = '65724758895-gc7lubjkjsqqddfhlb7jcme80i3mjqn0.apps.googleusercontent.com';\nvar API_KEY = 'AIzaSyCTYXWtoRKnXeZkPCcZwYOXm0Qz3Lz9F9g';\nvar GOOGLE_SCOPE = \"https://www.googleapis.com/auth/calendar.events\";\nvar OUTLOOK_CLIENT_ID = '6b770a68-2156-4345-b0aa-d95419e31be1';\nvar BASE_URL = 'https://login.microsoftonline.com/common/oauth2/v2.0/authorize?';\nvar OUTLOOK_SCOPE = 'openid profile Calendars.ReadWrite.Shared';\nvar PARAMS_URL = \"response_type=id_token+token&client_id=\".concat(OUTLOOK_CLIENT_ID, \"\\n                    &redirect_uri=http%3A%2F%2Flocalhost%3A3000%2Foutlook-redirect\\n                    &scope=\").concat(OUTLOOK_SCOPE, \"&state=f175f48d-d277-9893-9c8d-dcc2a95ffe16\\n                    &nonce=593a2b06-d77b-31c2-ae43-e74c0ebeb304\\n                    &response_mode=fragment\");\nvar GoogleAuth;\nexport var beginGoogleOldAuthEpic = function beginGoogleOldAuthEpic(action$) {\n  return action$.ofType(BEGIN_GOOGLE_AUTH).mergeMap(function () {\n    window.gapi.load('client:auth2', initClient()).map(function () {\n      debugger;\n      GoogleAuth = window.gapi.auth2.getAuthInstance();\n      var user = GoogleAuth.currentUser.get();\n      var isAuthorized = user.hasGrantedScopes(GOOGLE_SCOPE);\n\n      if (isAuthorized) {\n        return successGoogleAuth(user);\n      }\n    }).catch(function (error) {\n      return console.log(error);\n    });\n  });\n};\nexport var beginGoogleLoadAuthEpic = function beginGoogleLoadAuthEpic(action$) {\n  return action$.pipe(ofType(BEGIN_GOOGLE_LOAD), mergeMap(function () {\n    debugger;\n    window.gapi.load('client:auth2', initClient);\n    return beginGoogleAuthEpic();\n  }));\n};\nexport var beginGoogleAuthEpic = function beginGoogleAuthEpic(action$) {\n  return action$.pipe(ofType(BEGIN_GOOGLE_AUTH), mergeMap(function () {\n    debugger;\n    GoogleAuth = window.gapi.auth2.getAuthInstance();\n    var user = GoogleAuth.currentUser.get();\n    var isAuthorized = user.hasGrantedScopes(GOOGLE_SCOPE);\n\n    if (isAuthorized) {\n      return successGoogleAuth(user);\n    }\n  }));\n};\n\nvar initClient = function initClient() {\n  debugger;\n  window.gapi.client.init({\n    'apiKey': API_KEY,\n    'clientId': GOOGLE_CLIENT_ID,\n    'scope': GOOGLE_SCOPE,\n    'discoveryDocs': ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest']\n  }).then(function () {\n    GoogleAuth = window.gapi.auth2.getAuthInstance();\n    handleAuthClick();\n    GoogleAuth.isSignedIn.listen(updateSigninStatus);\n    setSigninStatus();\n  });\n};\n\nvar handleAuthClick = function handleAuthClick() {\n  if (GoogleAuth.isSignedIn.get()) {\n    GoogleAuth.signOut();\n  } else {\n    GoogleAuth.signIn();\n  }\n};\n\nvar updateSigninStatus = function updateSigninStatus(isSignedIn) {\n  _this.setSigninStatus();\n};\n\nvar setSigninStatus = function setSigninStatus() {\n  var user = GoogleAuth.currentUser.get();\n  var isAuthorized = user.hasGrantedScopes(GOOGLE_SCOPE);\n\n  if (isAuthorized) {\n    console.log(\"Authorized\");\n\n    _this.props.getGoogleEvents();\n  } else {\n    console.log(\"Not authorized\");\n  }\n};","map":{"version":3,"sources":["/Users/sham/big-calendar/src/epics/auth.js"],"names":["BEGIN_GOOGLE_AUTH","BEGIN_GOOGLE_LOAD","successGoogleAuth","mergeMap","ofType","GOOGLE_CLIENT_ID","API_KEY","GOOGLE_SCOPE","OUTLOOK_CLIENT_ID","BASE_URL","OUTLOOK_SCOPE","PARAMS_URL","GoogleAuth","beginGoogleOldAuthEpic","action$","window","gapi","load","initClient","map","auth2","getAuthInstance","user","currentUser","get","isAuthorized","hasGrantedScopes","catch","error","console","log","beginGoogleLoadAuthEpic","pipe","beginGoogleAuthEpic","client","init","then","handleAuthClick","isSignedIn","listen","updateSigninStatus","setSigninStatus","signOut","signIn","props","getGoogleEvents"],"mappings":"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","sourcesContent":["import { BEGIN_GOOGLE_AUTH, BEGIN_GOOGLE_LOAD, successGoogleAuth } from '../redux/actions';\nimport { mergeMap } from 'rxjs/operators';\nimport { ofType } from 'redux-observable';\nconst GOOGLE_CLIENT_ID = '65724758895-gc7lubjkjsqqddfhlb7jcme80i3mjqn0.apps.googleusercontent.com';\nconst API_KEY = 'AIzaSyCTYXWtoRKnXeZkPCcZwYOXm0Qz3Lz9F9g';\nconst GOOGLE_SCOPE = `https://www.googleapis.com/auth/calendar.events`;\nconst OUTLOOK_CLIENT_ID = '6b770a68-2156-4345-b0aa-d95419e31be1';\nconst BASE_URL = 'https://login.microsoftonline.com/common/oauth2/v2.0/authorize?';\nconst OUTLOOK_SCOPE = 'openid profile Calendars.ReadWrite.Shared';\nconst PARAMS_URL = `response_type=id_token+token&client_id=${OUTLOOK_CLIENT_ID}\n                    &redirect_uri=http%3A%2F%2Flocalhost%3A3000%2Foutlook-redirect\n                    &scope=${OUTLOOK_SCOPE}&state=f175f48d-d277-9893-9c8d-dcc2a95ffe16\n                    &nonce=593a2b06-d77b-31c2-ae43-e74c0ebeb304\n                    &response_mode=fragment`;\n\nvar GoogleAuth;\n\nexport const beginGoogleOldAuthEpic = action$ => action$.ofType(BEGIN_GOOGLE_AUTH)\n  .mergeMap(() => {\n      window.gapi.load('client:auth2', initClient())\n      .map(() => {\n        debugger\n        GoogleAuth = window.gapi.auth2.getAuthInstance()\n        const user = GoogleAuth.currentUser.get();\n        const isAuthorized = user.hasGrantedScopes(GOOGLE_SCOPE);\n        if(isAuthorized) {\n          return successGoogleAuth(user);\n        }\n      })\n      .catch(error => console.log(error))\n  })\n\nexport const beginGoogleLoadAuthEpic = action$ =>\n  action$.pipe(\n    ofType(BEGIN_GOOGLE_LOAD),\n    mergeMap(() => {\n      debugger\n      window.gapi.load('client:auth2', initClient);\n      return beginGoogleAuthEpic();\n    })\n  )\n\nexport const beginGoogleAuthEpic = action$ =>\n  action$.pipe(\n    ofType(BEGIN_GOOGLE_AUTH),\n    mergeMap(() => {\n          debugger\n          GoogleAuth = window.gapi.auth2.getAuthInstance()\n          const user = GoogleAuth.currentUser.get();\n          const isAuthorized = user.hasGrantedScopes(GOOGLE_SCOPE);\n          if(isAuthorized) {\n            return successGoogleAuth(user);\n          }\n    })\n  );\nconst initClient = () => {\n  debugger\n  window.gapi.client.init({\n      'apiKey': API_KEY,\n      'clientId': GOOGLE_CLIENT_ID,\n      'scope': GOOGLE_SCOPE,\n      'discoveryDocs': ['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],\n  }).then( () => {\n      GoogleAuth = window.gapi.auth2.getAuthInstance();\n      handleAuthClick();\n      GoogleAuth.isSignedIn.listen(updateSigninStatus);\n      setSigninStatus();\n  })\n}\n\nconst handleAuthClick = () => {\n  if (GoogleAuth.isSignedIn.get()) {\n      GoogleAuth.signOut();\n  } else {\n      GoogleAuth.signIn();\n    }\n}\n\nconst updateSigninStatus = (isSignedIn) => {\n  this.setSigninStatus();\n}\n\nconst setSigninStatus = () => {\n  var user = GoogleAuth.currentUser.get();\n  var isAuthorized = user.hasGrantedScopes(GOOGLE_SCOPE);\n  if (isAuthorized) {\n    console.log(\"Authorized\");\n    this.props.getGoogleEvents();\n  } else {\n    console.log(\"Not authorized\");\n  }\n}\n"]},"metadata":{},"sourceType":"module"}
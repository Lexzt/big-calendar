{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar ResponseHandler =\n/** @class */\nfunction () {\n  function ResponseHandler() {}\n\n  ResponseHandler.init = function (res, err, resContents, callback) {\n    if (res && res.ok) {\n      // 2xx\n      callback(null, resContents, res);\n    } else {\n      // not OK response\n      if (err == null && res != null) {\n        if (resContents != null && resContents.error != null) // if error was passed to body\n          callback(ResponseHandler.buildGraphErrorFromResponseObject(resContents.error, res.status), null, res);else callback(ResponseHandler.defaultGraphError(res.status), null, res);\n      } else // pass back error as first param\n        callback(ResponseHandler.ParseError(err), null, res);\n    }\n  };\n  /*\r\n      Example error for https://graph.microsoft.com/v1.0/me/events?$top=3&$search=foo\r\n      {\r\n          \"error\": {\r\n              \"code\": \"SearchEvents\",\r\n              \"message\": \"The parameter $search is not currently supported on the Events resource.\",\r\n              \"innerError\": {\r\n                  \"request-id\": \"b31c83fd-944c-4663-aa50-5d9ceb367e19\",\r\n                  \"date\": \"2016-11-17T18:37:45\"\r\n              }\r\n          }\r\n      }\r\n  */\n\n\n  ResponseHandler.ParseError = function (rawErr) {\n    // if we couldn't find an error obj to parse, just return an object with a status code and date\n    if (!rawErr) {\n      return ResponseHandler.defaultGraphError(-1);\n    }\n\n    return ResponseHandler.buildGraphErrorFromErrorObject(rawErr);\n  };\n\n  ResponseHandler.defaultGraphError = function (statusCode) {\n    return {\n      statusCode: statusCode,\n      code: null,\n      message: null,\n      requestId: null,\n      date: new Date(),\n      body: null\n    };\n  };\n\n  ResponseHandler.buildGraphErrorFromErrorObject = function (errObj) {\n    var error = ResponseHandler.defaultGraphError(-1);\n    error.body = errObj.toString();\n    error.message = errObj.message;\n    error.date = new Date();\n    return error;\n  };\n\n  ResponseHandler.buildGraphErrorFromResponseObject = function (errObj, statusCode) {\n    return {\n      statusCode: statusCode,\n      code: errObj.code,\n      message: errObj.message,\n      requestId: errObj.innerError !== undefined ? errObj.innerError[\"request-id\"] : \"\",\n      date: errObj.innerError !== undefined ? new Date(errObj.innerError.date) : new Date(),\n      body: errObj\n    };\n  };\n\n  return ResponseHandler;\n}();\n\nexports.ResponseHandler = ResponseHandler;","map":null,"metadata":{},"sourceType":"script"}